# R Linear Regression 

## Описание набора данных
Набор данных содержит наблюдения о проценте людей, каждый день ездящих на работу на велосипеде, проценте курящих людей и проценте людей с сердечно-сосудистыми заболеваниями в выборке из 500 городов.

## Exploratory Data Analysis
### Чтение данных из файла
heart.data <- read.csv("/data/heart.data.csv")

### Числовое описание данных
Выведем таблицу с числовой сводкой данных. В таблице представлены минимальное, медианное, квартили, среднее и максимальное значения независимых переменных (курение и езда на велосипеде) и зависимой переменной (болезнь сердца):
```r
summary(heart.data)
```
![summary(heart.data)](/images/image_1.png)

### График совместных распределений признаков
Видим около линейную зависимость между ездой на велосипеде и болезнью сердца. 
```r
pairs(heart.data)
```
![beaty table](/images/image_4.png)

### Матрица корреляций признаков
Проверяем взаимосвязь между независимыми переменными и убеждаемся, что они не слишком сильно коррелируют. Корреляция между ездой на велосипеде и курением невелика ($\approx 0.015$ — корреляция всего $\approx 1,5\%$), поэтому мы можем включить оба параметра в нашу модель.
```r
cor(heart.data)
```
![table in terminal](/images/image_2.png)
```r
ggcorrplot(cor(heart.data))
```
![beaty table](/images/image_3.png)

### Оценка нормальности зависимой переменной
```r
hist(heart.data$heart.disease)
```
![normality](/images/image_5.png)

### Построение модели линейной регрессии
Предполагаемый эффект от езды на велосипеде на сердечно-сосудистые заболевания составляет $-0.2$, а предполагаемый эффект курения - $0.178$.

Это означает, что на каждый 1% увеличения количества поездок на работу на велосипеде происходит соответствующее снижение заболеваемости сердечно-сосудистыми заболеваниями на 0.2%. Между тем, на каждый 1% увеличения курения приходится 0.178% увеличения заболеваемости сердечно-сосудистыми заболеваниями.

Стандартные ошибки для этих коэффициентов регрессии очень малы, а t-статистика очень велика (-147 и 50.4 соответственно). p-value отражают эти небольшие ошибки и большую t-статистику. Для обоих параметров практически нулевая вероятность того, что этот эффект обусловлен случайностью.
```r
heart.disease.lm<-lm(heart.disease ~ biking + smoking, data = heart.data)
summary(heart.disease.lm)
```
![linreg model](/images/image_6.png)

### Построение линии линейной регрессии
![linreg plot 1](/images/image_7.png)
![linreg plot 2](/images/image_8.png)
![linreg plot 3](/images/image_9.png)






